# MyShell.AI Test

项目包含多个测试文档生成:

- `test1.docx` - 标准段落测试
- `test2.docx` - 不同格式属性值测试
- `test3.docx` - 空段落和句号分隔测试
- `test4.docx` - 空段落和逗号分隔测试
- `test5.docx` - 仅包含两个单词的测试

## 测试文档生成

```bun run generate:test```

以防测试时没有Bun runtime, 我也提供了生成好的测试文档


## 基本使用

复制 `index.js`中的代码到word的script lab中, 然后运行即可


## 说明
1. 对于项目的要求调用word的javascript api，看上去微软并未提供其他外部引用的js sdk， 所以我暂时认为指的是office-js中的api。至于其他api，我发现了一种不需要使用任何word的api，只需要使用解压缩并从文件中读取样式的方法，参考 `zip-script.js`。我认为这种方法要好过现有的几乎所有解决方案。
2. 对于方案的选取，事实上这个任务在office-js提供的api中有很多方式实现，我个人认为最好的方法是使用Word.body.getHtml()方法，然后解析html，这样可以保证最大的兼容性，但是这个方法有一个问题，就是对于一些特殊的格式，比如表格，图片等，可能会有一些问题，所以我选择了另外一种方法，就是使用Word.body.paragraphs.getHtml()方法，这样可以保证最大的兼容性，但我感觉过于取巧，未必是考察的意图所以使用的是循环获取paragraph直到有3个单词出现，再轮流获取对应的font.
3. 测试方面，查看了微软官方的示例之后我发现现在并没有什么很好的测试方法的实现。官方实现了两种，一种是使用office-addin-mock库，另一种是在测试端启动一个http服务器，并在代码中插入http请求，将运行结果发送到服务器。第一种方法需要自己手动写mock object，事实上无法有效的测试代码的可用性，第二种需要在源代码中插入测试代码，实际上甚至会破坏源代码的可用性。所以暂时我只是生成测试案例并手动运行。
4. 为了展示编写测试的能力，我同样给 `zip-script.js`编写了测试。
5. 我使用的runtime是Bun，这主要出于个人的喜好。所以在node环境中运行会有一些问题，但我认为应该不会有什么影响，毕竟只是一些简单的api，如果需要在node中运行，只需要将跟bun内置api有关的代码改为node环境中的api或者一些外部的库即可。